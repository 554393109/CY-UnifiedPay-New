{"./":{"url":"./","title":"概述","keywords":"","body":"超赢聚合支付API在线文档 当前版本：v2.0.0 最后维护：尹自强，yinziqiang@chaoying.com.cn 更新日期：2018-08-16 版本说明 【v2.0.0】 2018-08-16 在线文档改版 【v1.0.18】 2018-07-02 微信公众号、小程序、APPx2支付时sub_appid改为必传项 【v1.0.17】 2018-06-27 商户进件接口地址修改 商户进件接口添加门头照和内景照参数 © 超赢科技 all right reserved，powered by Gitbook文件修订时间 2018-08-17 20:10:49 "},"rules.html":{"url":"rules.html","title":"接口规则","keywords":"","body":"协议规则 传输方式 为保证交易安全性，采用HTTPS传输（开发时可使用HTTP） 数据格式 若无指定，默认返回数据为JSON格式（application/json） 字符编码 统一采用UTF-8字符编码 内容类型 统一采用x-www-form-urlencoded编码格式 签名算法 MD5，后续会兼容SHA1、SHA256、HMAC等 签名要求 部份接口需要校验签名 签名验证 签名生成的通用步骤如下： 第一步，设所有传输的数据为集合M，将集合M内非空参数值的参数按照参数名ASCII码从小到大排序（字典序），使用URL键值对的格式（即key1=value1&key2=value2…）拼接成字符串stringA。 特别注意以下重要规则： 参数名ASCII码从小到大排序（字典序）； 如果参数的值为空不参与签名； 参数名区分大小写； 验证调用返回或主动通知签名时，传送的sign参数不参与签名，将生成的签名与该sign值作校验； 接口可能增加字段，验证签名时必须支持增加的扩展字段。 第二步，在stringA最后拼接上key得到stringSignTemp字符串（即stringA&key={KEY}），并对stringSignTemp进行MD5运算，再将得到的字符串所有字符转换为大写，得到sign值signValue。 请求格式 请求示例 // Javascript var settings = { \"async\": true, \"crossDomain\": true, \"url\": \"http://{BaseURL}/UnifiedPay/Gateway\", \"method\": \"POST\", \"headers\": { \"content-type\": \"application/x-www-form-urlencoded\", \"cache-control\": \"no-cache\", \"X-Requested-With\":\"XMLHttpRequest\", }, \"data\": { \"method\": \"pay\", \"mch_id\": \"00000001\", \"sign\", \"00000000000000000000000000000000\" } } $.ajax(settings).done(function (response) { console.log(response); }); # Python import requests url = \"http://{BaseURL}/UnifiedPay/Gateway\" payload = \"mch_id=00000001&method=pay&sign=00000000000000000000000000000000\" headers = { 'content-type': \"application/x-www-form-urlencoded\", 'cache-control': \"no-cache\", 'X-Requested-With': \"XMLHttpRequest\", } response = requests.request(\"POST\", url, data=payload, headers=headers) print(response.text) 响应格式 字段名 必填 类型 说明 state 是 String 通讯状态，详见参数规定 code 是 String 状态码 ，详见参数规定 msg 否 String 返回信息；若调用失败则为错误原因 trade_state 否 String 交易状态，详见参数规定 sign 是 String 响应结果的签名串 成功示例 { \"state\": \"SUCCESS\" \"code\": \"10000\", \"msg\": \"SUCCESS\", \"trade_state\": \"SUCCESS\", \"sign\": \"00000000000000000000000000000000\" } 失败示例 { \"state\": \"FAIL\" \"code\": \"10002\", \"msg\": \"签名错误\", \"sign\": \"00000000000000000000000000000000\" } © 超赢科技 all right reserved，powered by Gitbook文件修订时间 2018-08-17 20:10:49 "},"parameters.html":{"url":"parameters.html","title":"参数规定","keywords":"","body":" 编码统一使用大写 state - 通讯状态 编码 描述 SUCCESS 成功 FAIL 失败 VER 版本过低 code - 状态码 编码 描述 10000 成功 10001 支付中 10002 转入退款 10003 未支付 10004 已关闭 10005 已撤销 10006 支付错误 20002 签名错误 20003 响应结果签名错误 20004 参数错误 20005 商户错误 20006 系统错误 20007 订单不存在 20008 退款错误 20009 交易查询错误 20010 退款查询错误 20011 交易撤销错误 20012 代理商错误 20013 商户交易配置错误 30001 网络异常 scene - 支付场景 编码 描述 1 线下小额支付 2 公众号/服务窗支付 3 APP支付 4 原生扫码支付 trade_state - 交易状态 编码 描述 SUCCESS 成功 FAIL 失败 PROCESSING 处理中 NEED_QUERY 需要查询 REFUND 转入退款 paytype - 支付方式 编码 描述 WECHAT 微信支付 ALIPAY 支付宝支付 JDPAY 京东支付 QQ QQ钱包支付 UNIONPAY 银联支付 BESTPAY 翼支付 picType - 进件图片类型 编码 描述 1 二代身份证 2 营业执照 3 组织机构证件照 4 商户协议照 typeId - 图像识别类型 编码 描述 2 二代身份证正面 3 二代身份证背面 17 银行卡 2008 营业执照 DealType - 经营类型 编码 描述 0 实体 1 虚拟 LegalPersonType - 营业执照持有人类型 编码 描述 0 个人 1 企业 LegalPersonCertType - 法人证件类型 编码 描述 0 身份证 1 护照 （QrCodeMchApply - 商户进件）flag_type - 商户类型 编码 描述 0 个体户 1 企业 2 政府及事业单位 AccountType - 结算账户类型 编码 描述 1 企业 2 个人 IdCardType - 结算账户银行卡持卡人证件类型 编码 描述 1 身份证 2 护照 PaymentChannelId - 支付通道编码 编码 描述 SPDB 浦发 CEB 光大 BESTPAY 翼支付 TTG 淘淘谷 JDPAY 京东钱包 UNIONPAY 银联钱包 WECHAT 微信 ALIPAY 支付宝 MUNITEDPASS 汇商通盈 SAND 杉德 © 超赢科技 all right reserved，powered by Gitbook文件修订时间 2018-08-17 20:10:49 "},"api/micropay.html":{"url":"api/micropay.html","title":"线下小额支付","keywords":"","body":"线下小额支付 提交支付 应用场景 收银员使用扫码设备读取微信（或支付宝等电子钱包）用户刷卡授权码以后，调用该接口发起支付对用户进行收款。 接口详情 接口地址 https://{BaseURL}/UnifiedPay/Gateway 提交方式 POST 校验签名 是 公共请求参数 参数 必填 示例值 说明 method 是 pay 接口名称，pay agent_id 是 13000000000000001 代理商编号 version 否 1.0 调用方版本号 pid 否 yunpos 调用方产品名称 sign 是 00000000000000000000000000000000 请求参数的签名串 请求参数 参数 必填 示例值 说明 paytype 是 WECHAT 支付方式，详见参数规定 mch_id 是 00000001 超赢商户号 out_trade_no 是 1497769914931 商户系统内部的订单号 ,5到32个字符、 只能包含字母数字或者下划线，区分大小写，确保在商户系统唯一 device_info 否 013467007045764 终端设备号，商户自定义。特别说明：对于QQ钱包支付，此参数必传，否则会报错。 body 是 image形象店-深圳腾大- QQ公仔 商品描述 attach 否 说明 商户附加信息，可做扩展参数 total_fee 是 1 总金额，以分为单位，只能为整数 mch_create_ip 否 114.114.114.114 调用支付API的机器IP auth_code 是 120061098828009406 扫码支付授权码， 设备读取用户展示的条码信息 op_user_id 否 00000001 操作员帐号，默认为商户号 op_shop_id 否 md_001 门店编号 op_device_id 否 device_01 设备编号 goods_tag 否 hot 商品标记 请求参数示例 method=pay&mch_id=00000001&version=1.0&pid=yunpos&paytype=WECHAT&out_trade_no=1497769914931&auth_code=123123123&body=%E8%B6%85%E8%B5%A2%E6%94%AF%E4%BB%98&total_fee=1&sign=00000000000000000000000000000000 响应结果 字段名 必填 说明 state 是 通讯状态，详见参数规定 code 是 状态码 ，详见参数规定 msg 否 返回信息 trade_state 否 交易状态，详见参数规定 sign 是 响应结果的签名串 以下字段在state和trade_state都为SUCCESS的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 appid 是 调用接口提交的公众账号ID is_subscribe 是 用户是否关注公众账号，仅在公众账号类型支付有效，取值范围：Y或N；Y-关注；N-未关注 openid 是 用户在商户 appid 下的唯一标识 sub_appid 是 调用接口提交的子商户公众账号ID sub_is_subscribe 是 用户是否关注子公众账号，仅在公众账号类型支付有效，取值范围：Y或N;Y-关注;N-未关注 sub_openid 是 子商户appid下用户唯一标识，如需返回则请求时需要传sub_appid transaction_id 是 平台交易号 out_transaction_id 是 第三方订单号 out_trade_no 是 商户系统内部的定单号，32个字符内、可包含字母 total_fee 是 总金额，以分为单位，只能为整数 coupon_fee 否 代金券金额，代金券金额 fee_type 否 货币类型，符合 ISO 4217 标准的三位字母代码，默认人民币：CNY attach 否 商家数据包，原样返回 bank_type 否 付款银行 bank_billno 否 银行订单号，若为第三方支付则为空 time_end 是 支付完成时间，格式为yyyyMMddHHmmss，如2009年12月25日9点10分10秒表示为20091225091010。时区为GMT+8 Beijing nonce_str 是 随机字符串 响应结果示例 { \"state\": \"SUCCESS\", \"code\": \"10000\", \"trade_state\": \"SUCCESS\", \"msg\": \"SUCCESS\", \"mch_id\": \"00000001\", \"appid\": \"wx1f87d44db95cba7a\", \"is_subscribe\": \"N\", \"openid\": \"oywgtuCJFeGzT-QtF-8U7FHb1z3Q\", \"sub_appid\": \"wxce38685bc050ef82\", \"sub_is_subscribe\": \"N\", \"sub_openid\": \"oHmbktxFlpoEPo2Ol5GOJniV2q-A\", \"transaction_id\": \"7551000001201706196281085687\", \"out_transaction_id\": \"4005572001201706196460269701\", \"out_trade_no\": \"1497862554883\", \"total_fee\": \"1\", \"fee_type\": \"CNY\", \"bank_type\": \"CFT\", \"time_end\": \"20170619165616\", \"nonce_str\": \"a849df6660cb4354b6fe5b23120a73ce\", \"sign\": \"D292DB710872C023A9A1CF429457E0B3\" } 订单查询 应用场景 根据商户订单号或者平台订单号查询平台的具体订单信息。 接口详情 接口地址 https://{BaseURL}/UnifiedPay/Gateway 提交方式 POST 校验签名 是 公共请求参数 参数 必填 示例值 说明 method 是 orderquery 接口名称，orderquery agent_id 是 13000000000000001 代理商编号 version 否 1.0 调用方版本号 pid 否 yunpos 调用方产品名称 sign 是 00000000000000000000000000000000 请求参数的签名串 请求参数 参数 必填 示例值 说明 paytype 是 WECHAT 支付方式，详见参数规定 mch_id 是 00000001 超赢商户号 out_trade_no 否 1497769914931 商户系统内部的订单号，out_trade_no和transaction_id至少一个必填，同时存在时out_trade_no优先 transaction_id 否 7551000001201706166172780576 平台交易号，out_trade_no和transaction_id至少一个必填，同时存在时out_trade_no优先。 请求参数示例 method=orderquery&paytype=WECHAT&mch_id=00000001&out_trade_no=1497769914931&sign=00000000000000000000000000000000 响应结果 字段名 必填 说明 state 是 通讯状态，详见参数规定 code 是 状态码 ，详见参数规定 msg 否 返回信息 trade_state 否 交易状态，详见参数规定 sign 是 响应结果的签名串 以下字段在state和trade_state都为SUCCESS的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 appid 是 调用接口提交的公众账号ID is_subscribe 是 用户是否关注公众账号，仅在公众账号类型支付有效，取值范围：Y或N;Y-关注;N-未关注 openid 是 用户在商户 appid 下的唯一标识 sub_appid 是 调用接口提交的子商户公众账号ID sub_is_subscribe 是 用户是否关注子公众账号，仅在公众账号类型支付有效，取值范围：Y或N；Y-关注；N-未关注 sub_openid 是 子商户appid下用户唯一标识，如需返回则请求时需要传sub_appid transaction_id 是 平台交易号 out_transaction_id 是 第三方订单号 out_trade_no 是 商户系统内部的定单号，32个字符内、可包含字母 total_fee 是 总金额，以分为单位，只能为整数 coupon_fee 否 代金券金额，代金券金额 fee_type 否 货币类型，符合 ISO 4217 标准的三位字母代码，默认人民币：CNY attach 否 商家数据包，原样返回 bank_type 否 付款银行 bank_billno 否 银行订单号，若为第三方支付则为空 time_end 是 支付完成时间，格式为yyyyMMddHHmmss，如2009年12月25日9点10分10秒表示为20091225091010。时区为GMT+8 Beijing nonce_str 是 随机字符串 响应结果示例 { \"state\": \"SUCCESS\", \"code\": \"10000\", \"trade_state\": \"SUCCESS\", \"msg\": \"SUCCESS\", \"mch_id\": \"00000001\", \"appid\": \"wx1f87d44db95cba7a\", \"is_subscribe\": \"N\", \"openid\": \"oywgtuCJFeGzT-QtF-8U7FHb1z3Q\", \"sub_appid\": \"wxce38685bc050ef82\", \"sub_is_subscribe\": \"N\", \"sub_openid\": \"oHmbktxFlpoEPo2Ol5GOJniV2q-A\", \"transaction_id\": \"7551000001201706196281085687\", \"out_transaction_id\": \"4005572001201706196460269701\", \"out_trade_no\": \"1497862554883\", \"total_fee\": \"1\", \"fee_type\": \"CNY\", \"bank_type\": \"CFT\", \"time_end\": \"20170619165616\", \"nonce_str\": \"a849df6660cb4354b6fe5b23120a73ce\", \"sign\": \"D292DB710872C023A9A1CF429457E0B3\" } 交易退款 应用场景 商户针对某一个已经成功支付的订单发起退款，操作结果在同一会话中同步返回。 退款方式 目前只支持原路返回退款 说明：退到银行卡则是非实时的，每个银行的处理速度不同，一般发起退款后1-3个工作日内到账。 同一笔单的部分退款需要设置相同的订单号和不同的 out_refund_no 。一笔退款失败后重新提交，要采用原来 的out_refund_no。总退款金额不能超过用户实际支付金额(现金券金额不能退款) 退款限制 商户在退款操作时应该注意退款限制，避免发起不会成功的退款请求，下面是主要的退款限制： 在平台系统中，只要退款累计金额不超过交易单支付总额，一笔交易单可以多次退款，退款申请单号（退款接口中有此参数）唯一确定一次退款，而 不是交易单号确定一次退款。退款申请单号由商户生成，所以商户一定要保证退款申请单的唯一性。商家在退款过程中要特别注意，只有在能确定退 款失败的情况下，才能重新发起另一笔退款。 目前大多数银行都支持全额退款和部分退款，但是也有少数银行不支持全额退款或部分退款，或者不支持退款。在这种情况下，商户可以与买家协调， 线下直接退款给买家。 接口详情 接口地址 https://{BaseURL}/UnifiedPay/Gateway 提交方式 POST 校验签名 是 公共请求参数 参数 必填 示例值 说明 method 是 refund 接口名称，refund agent_id 是 13000000000000001 代理商编号 version 否 1.0 调用方版本号 pid 否 yunpos 调用方产品名称 sign 是 00000000000000000000000000000000 请求参数的签名串 请求参数 参数 必填 示例值 说明 paytype 是 WECHAT 支付方式，详见参数规定 mch_id 是 00000001 超赢商户号 out_trade_no 否 1497769914931 商户系统内部的订单号，out_trade_no和transaction_id至少一个必填，同时存在时transaction_id优先 transaction_id 否 7551000001201706166172780576 平台单号, out_trade_no和transaction_id至少一个必填，同时存在时transaction_id优先 out_refund_no 是 TK-1497769914931-01 商户退款单号，32个字符内、可包含字母，确保在商户系统唯一。同个退款单号多次请求，平台当一个单处理，只会退一次款。如果出现退款不成功，请采用原退款单号重新发起，避免出现重复退款。 total_fee 是 1 订单总金额，单位为分 refund_fee 是 1 退款金额，单位为分，可以做部分退款 op_user_id 是 00000001 操作员帐号，默认为商户号 scene 否 1 支付场景，默认为1刷卡支付；详见参数规定 请求参数示例 method=refund&paytype=WECHAT&mch_id=00000001&out_trade_no=1497769914931&out_refund_no=TK-1497769914931-01&sign=00000000000000000000000000000000 响应结果 字段名 必填 说明 state 是 通讯状态，详见参数规定 code 是 状态码 ，详见参数规定 msg 否 返回信息 trade_state 否 交易状态，详见参数规定 sign 是 响应结果的签名串 以下字段在state和trade_state都为SUCCESS的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 transaction_id 是 平台交易号 out_trade_no 是 商户系统内部的定单号，32个字符内、可包含字母 out_transaction_id 是 第三方退款单号 out_refund_no 是 商户退款单号 refund_id 是 平台退款单号 refund_channel 否 退款渠道，ORIGINAL—原路退款，默认 refund_fee 是 退款总金额，单位为分，可以做部分退款 coupon_refund_fee 是 现金券退款金额 nonce_str 是 随机字符串 响应结果示例 { \"state\": \"SUCCESS\", \"code\": \"10000\", \"trade_state\": \"SUCCESS\", \"msg\": \"SUCCESS\", \"mch_id\": \"00000001\", \"transaction_id\": \"7551000001201706196281179416\", \"out_trade_no\": \"1497769914931\", \"out_transaction_id\": \"4005572001201706196469530753\", \"out_refund_no\": \"TK-1497769914931\", \"refund_id\": \"7551000001201706215157548269\", \"refund_channel\": \"ORIGINAL\", \"refund_fee\": \"1\", \"nonce_str\": \"743dd9c1123c4015828f3d4216a1066c\", \"sign\": \"E0C19462FF594C1D3075D14AF1C17B87\" } 退款查询 应用场景 提交退款申请后， 通过调用该接口查询退款状态。 银行卡支付的退款有一定延时， 请在 3 个工作日后重新查询退款状态。 注意 如果单个支付订单部分退款次数超过20次请使用平台退款单号查询 若存在多条退款单时，退款状态请以refund_list中refund_status字段为准 接口详情 接口地址 https://{BaseURL}/UnifiedPay/Gateway 提交方式 POST 校验签名 是 公共请求参数 参数 必填 示例值 说明 method 是 refundquery 接口名称，refundquery agent_id 是 13000000000000001 代理商编号 version 否 1.0 调用方版本号 pid 否 yunpos 调用方产品名称 sign 是 00000000000000000000000000000000 请求参数的签名串 请求参数 参数 必填 示例值 说明 paytype 是 WECHAT 支付方式，详见参数规定 mch_id 是 00000001 超赢商户号 out_trade_no 否 1497769914931 商户系统内部的订单号，out_trade_no和transaction_id至少一个必填，同时存在时transaction_id优先 transaction_id 否 7551000001201706166172780576 平台交易号，out_trade_no和transaction_id至少一个必填，同时存在时transaction_id优先。 out_refund_no 否 TK-1497769914931-01 商户退款单号，32个字符内、可包含字母,确保在商户系统唯一。 refund_id 否 7551000001201706215157548269 平台退款单号关于refund_id、out_refund_no、out_trade_no 、transaction_id 四个参数必填一个， 如果同时存在优先级为：refund_id > out_refund_no > transaction_id > out_trade_no；特殊说明：如果是支付宝，refund_id、out_refund_no必填其中一个。 请求参数示例 method=refundquery&paytype=WECHAT&mch_id=00000001&out_trade_no=1497769914931&sign=00000000000000000000000000000000 响应结果 字段名 必填 说明 state 是 通讯状态，详见参数规定 code 是 状态码 ，详见参数规定 msg 否 返回信息 trade_state 否 交易状态，详见参数规定 sign 是 响应结果的签名串 以下字段在state和trade_state都为SUCCESS的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 appid 否 调用接口提交的公众账号ID is_subscribe 否 用户是否关注公众账号，仅在公众账号类型支付有效，取值范围：Y或N;Y-关注;N-未关注 openid 否 用户在商户 appid 下的唯一标识 sub_appid 否 调用接口提交的子商户公众账号ID sub_is_subscribe 否 用户是否关注子公众账号，仅在公众账号类型支付有效，取值范围：Y或N;Y-关注;N-未关注 sub_openid 否 子商户appid下用户唯一标识，如需返回则请求时需要传sub_appid transaction_id 是 平台交易号 out_transaction_id 是 第三方订单号 out_trade_no 是 商户系统内部的定单号，32个字符内、可包含字母 refund_count 是 退款笔数 refund_fee_summary 是 退款汇总金额，以分为单位，只能为整数 refund_list 是 退款单集合 nonce_str 是 随机字符串 以下字段在refund_list中返回 字段名 必填 说明 serial_no 是 退款序号，按退款申请时间升序排列 refund_id 是 平台退款单号 out_refund_id 是 第三方退款单号 out_refund_no 是 商户退款单号 refund_channel 否 退款渠道，ORIGINAL—原路退款，默认 refund_fee 是 当次退款金额，以分为单位，只能为整数 refund_status 是 退款状态：SUCCESS—退款成功；FAIL—退款失败；PROCESSING—退款处理中；NOTSURE—未确定， 需要商户原退款单号重新发起；CHANGE—转入代发，退款到银行发现用户的卡作废或者冻结了，导致原路退款银行卡失败，资金回流到商户的现金帐号，需要商户人工干预，通过线下或者平台转账的方式进行退款。 refund_time 否 退款时间，格式为yyyyMMddHHmmss，如2009年12月25日9点10分10秒表示为20091225091010。时区为GMT+8 Beijing coupon_refund_fee 否 现金券退款金额 响应结果示例 { \"state\": \"SUCCESS\", \"code\": \"10000\", \"trade_state\": \"SUCCESS\", \"msg\": \"SUCCESS\", \"mch_id\": \"00000001\", \"appid\": \"wxe00fda5293a2fa25\", \"transaction_id\": \"199520175115201706224112697859\", \"out_transaction_id\": \"4005572001201706226919222698\", \"out_trade_no\": \"1498125915060\", \"refund_list\": \"[{\\\"serial_no\\\":\\\"0\\\",\\\"refund_id\\\":\\\"199520175115201706224212715917\\\",\\\"out_refund_id\\\":\\\"50000203302017062201274913961\\\",\\\"out_refund_no\\\":\\\"TK-1498125915060-0.02\\\",\\\"refund_channel\\\":\\\"ORIGINAL\\\",\\\"refund_fee\\\":\\\"2\\\",\\\"refund_status\\\":\\\"SUCCESS\\\",\\\"refund_time\\\":\\\"20170622182219\\\"},{\\\"serial_no\\\":\\\"1\\\",\\\"refund_id\\\":\\\"199520175115201706226290021966\\\",\\\"out_refund_id\\\":\\\"50000203302017062201275383549\\\",\\\"out_refund_no\\\":\\\"TK-1498125915060-0.01-1\\\",\\\"refund_channel\\\":\\\"ORIGINAL\\\",\\\"refund_fee\\\":\\\"1\\\",\\\"refund_status\\\":\\\"SUCCESS\\\",\\\"refund_time\\\":\\\"20170622181822\\\"}]\", \"refund_fee_summary\": \"3\", \"refund_count\": \"2\", \"nonce_str\": \"65f753cf49f049c4ab434a7caa75449c\", \"sign\": \"0FB65206D136E3A09D63B905F91D3B6B\" } 交易撤销 应用场景 当支付返回失败，或收银系统超时需要取消交易，可以调用该接口。接口逻辑 ： 支付失败的关单，支付成功的撤销支付。注意：5分钟的订单才可以撤销，其他正常支付的单如需实现相同功能请调用退款接口。 调用支付接口后请勿立即调用撤销订单接口，建议支付后至少15s后再调用撤销订单接口。 接口详情 接口地址 https://{BaseURL}/UnifiedPay/Gateway 提交方式 POST 校验签名 是 公共请求参数 参数 必填 示例值 说明 method 是 cancel 接口名称 agent_id 是 13000000000000001 代理商编号 version 否 1.0 调用方版本号 pid 否 yunpos 调用方产品名称 sign 是 00000000000000000000000000000000 请求参数的签名串 请求参数 参数 必填 示例值 说明 paytype 是 WECHAT 支付方式，详见参数规定 mch_id 是 00000001 超赢商户号 out_trade_no 是 1497769914931 商户系统内部的订单号 ,5到32个字符、 只能包含字母数字或者下划线，区分大小写，确保在商户系统唯一 op_user_id 是 00000001 操作员帐号 scene 否 1 支付场景，默认为1刷卡支付；详见参数规定 请求参数示例 method=cancel&paytype=WECHAT&mch_id=00000001&out_trade_no=1497769914931&op_user_id=yzq&sign=00000000000000000000000000000000 响应结果 字段名 必填 说明 state 是 通讯状态，详见参数规定 code 是 状态码 ，详见参数规定 msg 否 返回信息 trade_state 否 交易状态，详见参数规定 sign 是 响应结果的签名串 以下字段在state和trade_state都为SUCCESS的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 nonce_str 是 随机字符串 响应结果示例 { \"state\": \"SUCCESS\", \"code\": \"10000\", \"trade_state\": \"SUCCESS\", \"msg\": \"SUCCESS\", \"mch_id\": \"00000001\", \"nonce_str\": \"f1625e94362d4d82aafcc5fc9d1f9325\", \"sign\": \"192D6CBDEFE6DC1B69DF50B8420D8908\" } © 超赢科技 all right reserved，powered by Gitbook文件修订时间 2018-08-17 20:10:49 "},"api/preorderpay.html":{"url":"api/preorderpay.html","title":"预下单支付","keywords":"","body":"预下单支付 微信预下单 应用场景 用户通过微信公众号或扫描二维码，可以支付完成下单购买流程。 接口详情 接口地址 https://{BaseURL}/Open/WECHAT_PreOrder 提交方式 POST 校验签名 是 公共请求参数 参数 必填 示例值 说明 agent_id 是 13000000000000001 代理商编号 nonce_str 否 00000000000000000000000000000000 随机字符串 sign 是 00000000000000000000000000000000 请求参数的签名串 请求参数 参数 必填 示例值 说明 mch_id 是 00000001 超赢商户号 sub_appid 是 wxaee08d155d9de0c5 公众号AppId。trade_type=JSPAY、APP、APP_BANK时，此参数必传 is_minipg 否 1 是否小程序支付。1：小程序支付；0：表示公众号支付 buyer_id 否 oRA5quGvJc1wwvjMW-tnpLLqD-FM 在sub_appid下通过微信授权取得的买家sub_openid。trade_type=JSPAY，此参数必传 device_info 否 013467007045764 终端设备号，商户自定义。 body 是 image形象店-深圳腾大- QQ公仔 商品描述 attach 否 说明 商户附加信息，可做扩展参数 out_trade_no 是 1497769914931 商户系统内部的订单号 ,5到32个字符、 只能包含字母数字，区分大小写，确保在商户系统唯一 total_fee 是 1 总金额，以分为单位，只能为整数 mch_create_ip 否 114.114.114.114 调用支付API的机器IP time_start 否 20091225091010 交易起始时间，格式为yyyyMMddHHmmss，如2009年12月25日9点10分10秒表示为20091225091010。时区为GMT+8 Beijing time_expire 否 20091225091510 交易结束时间，格式为yyyyMMddHHmmss，如2009年12月25日9点15分10秒表示为20091225091510。时区为GMT+8 Beijing goods_tag 否 WXG 订单优惠标记，用于优惠券或者满减使用 notify_url 否 http://baidu.com/notify 接收支付异步通知回调地址，通知url必须为直接可访问的url，不能携带参数 op_user_id 否 00000001 操作员帐号，默认为商户号 limit_pay 否 NO_CREDIT no_credit指定不能使用信用卡支付 trade_type 是 JSPAY 交易类型；JSPAY-服务窗支付、NATIVE-原生扫码支付、APP-APP支付，APP_BANK-APP支付银行模式 product_id 否 1223541321407035645 trade_type=NATIVE，此参数必传。此id为二维码中包含的商品ID，商户自行定义 请求参数示例 agent_id=13000000000000001&mch_id=00000001™_type=NATIVE&body=超赢支付聚合支付&out_trade_no=1497769914931&total_fee=1&sign=00000000000000000000000000000000 响应结果 字段名 必填 说明 state 是 通讯状态，详见参数规定 code 是 状态码 ，详见参数规定 msg 否 返回信息 trade_state 否 交易状态，详见参数规定 以下字段在state和trade_state都为SUCCESS的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 appid 是 调用接口提交的公众账号ID sub_openid 是 子商户appid下用户唯一标识，如需返回则请求时需要传sub_appid out_trade_no 是 商户系统内部的定单号，32个字符内、可包含字母 token_id 是 动态口令 pay_info 是 支付信息，用以唤起微信支付 services 否 支持的交易类型，多个以竖线分割 nonce_str 是 随机字符串 响应结果示例 { \"state\": \"SUCCESS\", \"code\": \"10000\", \"trade_state\": \"SUCCESS\", \"msg\": \"SUCCESS\", \"mch_id\": \"3338102513618944\", \"out_trade_no\": \"1497769914931\", \"token_id\": \"16c5f40274e084b123a08f1313d53da57\", \"pay_info\": \"{\\\"appId\\\":\\\"wxc3d2e734ae326831\\\",\\\"timeStamp\\\":\\\"1511947589427\\\",\\\"status\\\":\\\"0\\\",\\\"signType\\\":\\\"MD5\\\",\\\"package\\\":\\\"prepay_id=wx2017112917262941a3a33e980001282756\\\",\\\"callback_url\\\":\\\"\\\",\\\"nonceStr\\\":\\\"1511947589427\\\",\\\"paySign\\\":\\\"CD871BCD09B3D0C6339B2D0DE72DE7EE\\\"}\", \"nonce_str\": \"14a9edad51c2403f9318c6d699152168\" } 支付宝预下单 应用场景 用户通过支付宝服务窗或扫描二维码，可以支付完成下单购买流程。 接口详情 接口地址 https://{BaseURL}/Open/ALIPAY_PreOrder 提交方式 POST 校验签名 是 公共请求参数 参数 必填 示例值 说明 agent_id 是 13000000000000001 代理商编号 nonce_str 否 00000000000000000000000000000000 随机字符串 sign 是 00000000000000000000000000000000 请求参数的签名串 请求参数 参数 必填 示例值 说明 mch_id 是 00000001 超赢商户号 device_info 否 013467007045764 终端设备号，商户自定义。 body 是 image形象店-深圳腾大- QQ公仔 商品描述 attach 否 说明 商户附加信息，可做扩展参数 out_trade_no 是 1497769914931 商户系统内部的订单号 ,5到32个字符、 只能包含字母数字，区分大小写，确保在商户系统唯一 total_fee 是 1 总金额，以分为单位，只能为整数 mch_create_ip 否 114.114.114.114 调用支付API的机器IP time_start 否 20091225091010 交易起始时间，格式为yyyyMMddHHmmss，如2009年12月25日9点10分10秒表示为20091225091010。时区为GMT+8 Beijing。注：交易起始时间与交易结束时间需要同时传入才会生效。 time_expire 否 20091225091510 交易结束时间，格式为yyyyMMddHHmmss，如2009年12月25日9点15分10秒表示为20091225091510。时区为GMT+8 Beijing。注：交易起始时间与交易结束时间需要同时传入才会生效。 goods_tag 否 WXG 订单优惠标记，用于优惠券或者满减使用 notify_url 否 http://baidu.com/notify 接收支付异步通知回调地址，通知url必须为直接可访问的url，不能携带参数 op_user_id 否 00000001 操作员帐号，默认为商户号 limit_pay 否 NO_CREDIT no_credit指定不能使用信用卡支付 trade_type 是 NATIVE 交易类型；JSPAY-服务窗支付、NATIVE-原生扫码支付、APP-APP支付，APP_BANK-APP支付银行模式 product_id 否 1223541321407035645 trade_type=JSPAY时，此参数必传。此id为二维码中包含的商品ID，商户自行定义 buyer_logon_id 否 13800000000 买家支付宝账号。trade_type=JSPAY时，和buger_id不能同时为空 buyer_id 否 2088822494428872 买家支付宝用户ID。trade_type=JSPAY时，和buyer_logon_id不能同时为空 请求参数示例 agent_id=13000000000000001&mch_id=00000001&body=超赢支付聚合支付&out_trade_no=1497769914931&total_fee=1™_type=NATIVE&sign=00000000000000000000000000000000 响应结果 字段名 必填 说明 state 是 通讯状态，详见参数规定 code 是 状态码 ，详见参数规定 msg 否 返回信息 trade_state 否 交易状态，详见参数规定 以下字段在state和trade_state都为SUCCESS的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 out_trade_no 是 商户系统内部的定单号，32个字符内、可包含字母 pay_info 是 JSON字符串，自行唤起支付宝钱包支付；trade_type=JSPAY时，此参数有返回 pay_url 是 仅作为参考使用，商户需自己实现该支付页面；trade_type=JSPAY时，此参数有返回 code_img_url 是 此参数的值即是根据code_url生成的可以扫码支付的二维码图片地址；trade_type=NATIVE时，此参数有返回 code_url 是 商户可用此参数自定义去生成二维码后展示出来进行扫码支付；trade_type=NATIVE时，此参数有返回 nonce_str 是 随机字符串 响应结果示例 { \"state\": \"SUCCESS\", \"code\": \"10000\", \"trade_state\": \"SUCCESS\", \"msg\": \"SUCCESS\", \"mch_id\": \"3338102513618944\", \"out_trade_no\": \"1523265111702\", \"code_img_url\": \"https://pay.swiftpass.cn/pay/qrcode?uuid=https%3A%2F%2Fqr.alipay.com%2Fbax04486r0vgbxds3h55805a\", \"code_url\": \"https://qr.alipay.com/bax04486r0vgbxds3h55805a\", \"nonce_str\": \"f032dd959bb0428ba01d58dad8a70ffa\" } 微信预下单结果通知 应用场景 通知 URL 是初始化请求接口中提交的参数 notify_url，支付完成后，平台会把相关支付和用户信息发送到该 URL，商户需要接收处理信息。 对后台通知交互时，如果平台收到商户的应答不是纯字符串success或超过3秒后返回时，平台认为通知失败，平台会通过一定的策略（通知频率为0/15/15/30/180/1800/1800/1800/1800/3600，单位：秒）间接性重新发起通知，尽可能提高通知的成功率，但不保证通知最终能成功。 由于存在重新发送后台通知的情况， 因此同样的通知可能会多次发送给商户系统。商户系统必须能够正确处理重复的通知。 推荐的做法是， 当收到通知进行处理时， 首先检查对应业务数据的状态， 判断该通知是否已经处理过， 如果没有处理过再进行处理， 如果处理过直接返回结果成功。 在对业务数据进行状态检查和处理之前， 要采用数据锁进行并发控制， 以避免函数重入造成的数据混乱。 特别注意：商户后台接收到通知参数后，一定要对接收到通知参数里的订单号out_trade_no和订单金额total_fee和自身业务系统的订单和金额做校验，校验一致后才更新数据库订单状态，防止数据泄漏导致出现“假通知”，造成资金损失。 后台通知通过请求中的notify_url进行， POST方式给商户系统（通知参数内容为HASH的字符串） 接口详情 接口地址 该链接是通过微信预下单接口中提交的参数notify_url设置，如果链接无法访问，商户将无法接收到通知。 提交方式 POST 校验签名 是 通知参数 字段名 必填 说明 state 是 通讯状态，详见参数规定 result_code 是 状态码 ，0-成功，其他-失败 sign 是 通知的签名串 以下字段在state和trade_state都为0的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 device_info 否 终端设备号 pay_result 是 支付结果：0—成功；其它—失败 out_trade_no 是 商户系统内部的订单号，32个字符内、可包含字母 out_transaction_id 是 第三方订单号 transaction_id 是 平台交易号 fee_type 否 货币类型，符合 ISO 4217 标准的三位字母代码，默认人民币：CNY total_fee 是 总金额，以分为单位，只能为整数 coupon_fee 否 代金券金额，代金券金额 time_end 是 支付完成时间，格式为yyyyMMddHHmmss，如2009年12月25日9点10分10秒表示为20091225091010。时区为GMT+8 Beijing bank_type 否 付款银行 trade_type 是 交易类型；pay.alipay.native原生扫码支付，pay.alipay.jspay服务窗支付 sub_appid 否 调用接口提交的子商户公众账号ID sub_openid 否 子商户appid下用户唯一标识，用户关注时存在 nonce_str 是 随机字符串 请求参数示例 bank_type=CFT&mch_id=f20170519135901860000&nonce_str=1523929649387&out_trade_no=1523929500000&out_transaction_id=2018041721001004870537670226&pay_result=0&result_code=SUCCESS&sign=00000000000000000000000000000000&state=SUCCESS&time_end=20180417094729&total_fee=1&trade_type=pay.weixin.native&transaction_id=199520439266201804177199552446 后台通知结果反馈 返回结果 结果说明 success 处理成功，平台收到此结果后不再进行后续通知 fail或其它字符 处理不成功，平台收到此结果或者没有收到任何结果，系统通过补单机制再次通知 支付宝预下单结果通知 应用场景 通知 URL 是初始化请求接口中提交的参数 notify_url，支付完成后，平台会把相关支付和用户信息发送到该 URL，商户需要接收处理信息。 对后台通知交互时，如果平台收到商户的应答不是纯字符串success或超过3秒后返回时，平台认为通知失败，平台会通过一定的策略（通知频率为0/15/15/30/180/1800/1800/1800/1800/3600，单位：秒）间接性重新发起通知，尽可能提高通知的成功率，但不保证通知最终能成功。 由于存在重新发送后台通知的情况， 因此同样的通知可能会多次发送给商户系统。商户系统必须能够正确处理重复的通知。 推荐的做法是， 当收到通知进行处理时， 首先检查对应业务数据的状态， 判断该通知是否已经处理过， 如果没有处理过再进行处理， 如果处理过直接返回结果成功。 在对业务数据进行状态检查和处理之前， 要采用数据锁进行并发控制， 以避免函数重入造成的数据混乱。 特别注意：商户后台接收到通知参数后，一定要对接收到通知参数里的订单号out_trade_no和订单金额total_fee和自身业务系统的订单和金额做校验，校验一致后才更新数据库订单状态，防止数据泄漏导致出现“假通知”，造成资金损失。 后台通知通过请求中的notify_url进行， POST方式给商户系统（通知参数内容为HASH的字符串） 接口详情 接口地址 该链接是通过支付宝预下单接口中提交的参数notify_url设置，如果链接无法访问，商户将无法接收到通知。 提交方式 POST 校验签名 是 通知参数 字段名 必填 说明 state 是 通讯状态，详见参数规定 result_code 是 状态码 ，0-成功，其他-失败 sign 是 通知的签名串 以下字段在state和trade_state都为0的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 device_info 否 终端设备号 pay_result 是 支付结果：0—成功；其它—失败 out_trade_no 是 商户系统内部的订单号，32个字符内、可包含字母 out_transaction_id 是 第三方订单号 transaction_id 是 平台交易号 fee_type 否 货币类型，符合 ISO 4217 标准的三位字母代码，默认人民币：CNY total_fee 是 总金额，以分为单位，只能为整数 invoice_amount 否 用户在交易中支付的可开发票的金额 time_end 是 支付完成时间，格式为yyyyMMddHHmmss，如2009年12月25日9点10分10秒表示为20091225091010。时区为GMT+8 Beijing bank_type 否 付款银行 trade_type 是 交易类型；pay.alipay.native原生扫码支付，pay.alipay.jspay服务窗支付 buyer_user_id 是 买家支付宝用户ID buyer_logon_id 是 买家支付宝账号 fund_bill_list 否 交易支付使用的资金渠道 nonce_str 是 随机字符串 请求参数示例 bank_type=ALIPAYACCOUNT&buyer_logon_id=13800000000%40qq.com&buyer_user_id=2088822494428000&device_info=device_info_yzq_01&fee_type=CNY&fund_bill_list=%5b%7b%22amount%22%3a%220.01%22%2c%22fundChannel%22%3a%22ALIPAYACCOUNT%22%7d%5d&gmt_create=20180417094613&invoice_amount=1&mch_id=f20170519135901860000&nonce_str=1523929649387&out_trade_no=1523929500000&out_transaction_id=2018041721001004870537670226&pay_result=0&result_code=SUCCESS&sign=00000000000000000000000000000000&state=SUCCESS&time_end=20180417094729&total_fee=1&trade_type=pay.alipay.native&transaction_id=199520439266201804177199552446 后台通知结果反馈 返回结果 结果说明 success 处理成功，平台收到此结果后不再进行后续通知 fail或其它字符 处理不成功，平台收到此结果或者没有收到任何结果，系统通过补单机制再次通知 © 超赢科技 all right reserved，powered by Gitbook文件修订时间 2018-08-17 20:10:49 "},"api/operation.html":{"url":"api/operation.html","title":"运维管理","keywords":"","body":"运维管理 注册超赢虚拟商户 应用场景 该接口提供第三方接入使用我方聚合支付业务时注册成超赢虚拟商户功能。 接口详情 接口地址 https://{BaseURL}/UnifiedPay/Mch_Reg 提交方式 POST 校验签名 是 公共请求参数 参数 必填 示例值 说明 agent_id 是 13000000000000001 代理商编号 version 否 1.0 调用方版本号 pid 否 yunpos 调用方产品名称 sign 是 00000000000000000000000000000000 请求参数的签名串 请求参数 参数 必填 示例值 说明 url_path 否 https://api.domain.com/ 接口地址，以斜杠结尾 - 是 - 具体参数，联调时请联系技术支持获取 请求参数示例 key1=aaa&key2=bbb&sign=00000000000000000000000000000000 响应结果 字段名 必填 说明 state 是 通讯状态，详见参数规定 code 是 状态码 ，详见参数规定 msg 否 返回信息 sign 是 响应结果的签名串 以下字段在state为SUCCESS，code为10000的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 响应结果示例 { \"state\": \"SUCCESS\", \"code\": \"10000\", \"msg\": \"SUCCESS\", \"mch_id\": \"00000001\", \"nonce_str\": \"f1625e94362d4d82aafcc5fc9d1f9325\", \"sign\": \"00000000000000000000000000000000\" } 获取超赢商户号 应用场景 该接口提供使用手机号获取超赢商户号功能。 接口详情 接口地址 https://{BaseURL}/Mch/GetMchId 提交方式 POST 校验签名 是 公共请求参数 参数 必填 示例值 说明 agent_id 是 13000000000000001 代理商编号 version 否 1.0 调用方版本号 pid 否 yunpos 调用方产品名称 sign 是 00000000000000000000000000000000 请求参数的签名串 请求参数 参数 必填 示例值 说明 keyword 是 13800000000 手机号或超赢商户号 请求参数示例 agent_id=13000000000000001&keyword=13800000000&sign=00000000000000000000000000000000 响应结果 字段名 必填 说明 state 是 通讯状态，详见参数规定 code 是 状态码 ，详见参数规定 msg 否 返回信息 sign 是 响应结果的签名串 以下字段在state为SUCCESS，code为10000的时候有返回 字段名 必填 说明 mch_id 是 超赢商户号 响应结果示例 { \"state\": \"SUCCESS\", \"code\": \"10000\", \"msg\": \"SUCCESS\", \"mch_id\": \"00000001\", \"nonce_str\": \"f1625e94362d4d82aafcc5fc9d1f9325\", \"sign\": \"00000000000000000000000000000000\" } © 超赢科技 all right reserved，powered by Gitbook文件修订时间 2018-08-17 20:10:49 "},"GLOSSARY.html":{"url":"GLOSSARY.html","keywords":"","body":"版本说明 这是新版聚合支付API在线文档 © 超赢科技 all right reserved，powered by Gitbook文件修订时间 2018-08-17 20:10:49 "}}